<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Kronnos Chat</title> <style> * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #000000; height: 100vh; display: flex; justify-content: center; align-items: center; } .chat-container { width: 90%; max-width: 800px; height: 85vh; background: #1a1a1a; border-radius: 15px; border: 2px solid #333; box-shadow: 0 8px 32px rgba(255, 255, 255, 0.1); display: flex; flex-direction: column; overflow: hidden; } .chat-header { background: #000000; color: white; padding: 20px; text-align: center; font-size: 24px; font-weight: bold; border-bottom: 2px solid #333; } .messages-container { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; background: #1a1a1a; } .messages-container::-webkit-scrollbar { width: 8px; } .messages-container::-webkit-scrollbar-track { background: #000000; border-radius: 10px; } .messages-container::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; } .message { display: flex; align-items: flex-start; gap: 10px; animation: slideIn 0.3s ease; } @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } .message.own { flex-direction: row-reverse; } .message-avatar { width: 40px; height: 40px; border-radius: 50%; background: #333; border: 2px solid #666; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; flex-shrink: 0; } .message.own .message-avatar { background: #ffffff; color: #000000; border: 2px solid #ffffff; } .message-content { max-width: 60%; background: #2a2a2a; padding: 12px 16px; border-radius: 15px; border: 1px solid #333; word-wrap: break-word; color: #ffffff; } .message.own .message-content { background: #ffffff; color: #000000; border: 1px solid #ffffff; } .message-username { font-weight: bold; font-size: 12px; margin-bottom: 5px; opacity: 0.8; } .message-text { font-size: 14px; line-height: 1.4; } .message-time { font-size: 11px; opacity: 0.6; margin-top: 5px; } .input-container { padding: 20px; background: #000000; border-top: 2px solid #333; display: flex; gap: 10px; } .username-input { padding: 12px 16px; border: 2px solid #333; border-radius: 25px; font-size: 14px; outline: none; width: 150px; transition: all 0.3s; background: #1a1a1a; color: white; } .username-input:focus { border-color: #666; box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1); } .message-input { flex: 1; padding: 12px 16px; border: 2px solid #333; border-radius: 25px; font-size: 14px; outline: none; transition: all 0.3s; background: #1a1a1a; color: white; } .message-input:focus { border-color: #666; box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1); } .send-button { padding: 12px 30px; background: #ffffff; color: #000000; border: none; border-radius: 25px; font-size: 14px; font-weight: bold; cursor: pointer; transition: all 0.3s; } .send-button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3); } .send-button:active { transform: translateY(0); } .online-count { background: #333; padding: 5px 15px; border-radius: 20px; font-size: 14px; margin-top: 5px; } .login-form { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 20px; padding: 40px; } .login-input { width: 100%; max-width: 350px; padding: 15px 20px; border: 2px solid #333; border-radius: 10px; font-size: 16px; outline: none; transition: all 0.3s; background: #1a1a1a; color: white; } .login-input:focus { border-color: #666; box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.1); } .login-button { width: 100%; max-width: 350px; padding: 15px 30px; background: #ffffff; color: #000000; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; } .login-button:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(255, 255, 255, 0.3); } .login-button:active { transform: translateY(0); } .login-info { color: #999; font-size: 12px; text-align: center; } .current-user { padding: 12px 20px; background: #2a2a2a; border: 1px solid #333; border-radius: 25px; color: white; font-size: 14px; font-weight: bold; } </style> </head> <body> <div class="chat-container" id="loginContainer"> <div class="chat-header"> Kronnos Chat - Login </div> <div class="login-form"> <input type="text" class="login-input" id="loginUsername" placeholder="Username" maxlength="20" > <input type="password" class="login-input" id="loginPassword" placeholder="Password" maxlength="50" > <button class="login-button" id="loginButton">Login / Register</button> <div class="login-info">Your account will be saved to this device</div> </div> </div> <div class="chat-container" id="chatContainer" style="display: none;"> <div class="chat-header"> Kronnos Chat <div class="online-count" id="onlineCount">0 online</div> </div> <div class="messages-container" id="messagesContainer"> </div> <div class="input-container"> <div class="current-user" id="currentUser"></div> <input type="text" class="message-input" id="messageInput" placeholder="Type a message..." maxlength="500" > <button class="send-button" id="sendButton">Send</button> </div> </div> <script> const loginContainer = document.getElementById('loginContainer'); const chatContainer = document.getElementById('chatContainer'); const loginUsername = document.getElementById('loginUsername'); const loginPassword = document.getElementById('loginPassword'); const loginButton = document.getElementById('loginButton'); const messagesContainer = document.getElementById('messagesContainer'); const messageInput = document.getElementById('messageInput'); const sendButton = document.getElementById('sendButton'); const onlineCount = document.getElementById('onlineCount'); const currentUser = document.getElementById('currentUser'); let ws; let reconnectInterval; let username = ''; let passwordHash = ''; async function hashPassword(password) { const encoder = new TextEncoder(); const data = encoder.encode(password); const hashBuffer = await crypto.subtle.digest('SHA-256', data); const hashArray = Array.from(new Uint8Array(hashBuffer)); return hashArray.map(b => b.toString(16).padStart(2, '0')).join(''); } async function handleLogin() { const user = loginUsername.value.trim(); const pass = loginPassword.value.trim(); if (!user || !pass) { alert('Please enter both username and password'); return; } const hash = await hashPassword(pass); const savedUser = localStorage.getItem('kronnos_username'); const savedHash = localStorage.getItem('kronnos_password'); if (savedUser && savedHash) { if (savedUser === user && savedHash === hash) { username = user; passwordHash = hash; showChat(); } else { alert('Invalid credentials for this device'); } } else { localStorage.setItem('kronnos_username', user); localStorage.setItem('kronnos_password', hash); username = user; passwordHash = hash; showChat(); } } function showChat() { loginContainer.style.display = 'none'; chatContainer.style.display = 'flex'; currentUser.textContent = username; connectWebSocket(); messageInput.focus(); } function connectWebSocket() { ws = new WebSocket('ws://localhost:5001'); ws.onopen = () => { console.log('Connected to chat server'); clearInterval(reconnectInterval); ws.send(JSON.stringify({ type: 'auth', username: username, passwordHash: passwordHash })); }; ws.onmessage = (event) => { const data = JSON.parse(event.data); if (data.type === 'message') { addMessage(data.username, data.message, data.timestamp, data.username === username); } else if (data.type === 'userCount') { onlineCount.textContent = `${data.count} online`; } }; ws.onclose = () => { console.log('Disconnected from chat server'); reconnectInterval = setInterval(connectWebSocket, 3000); }; ws.onerror = (error) => { console.error('WebSocket error:', error); }; } function addMessage(user, text, timestamp, isOwn) { const messageDiv = document.createElement('div'); messageDiv.className = `message ${isOwn ? 'own' : ''}`; const avatar = document.createElement('div'); avatar.className = 'message-avatar'; avatar.textContent = user.charAt(0).toUpperCase(); const content = document.createElement('div'); content.className = 'message-content'; const time = new Date(timestamp); const timeStr = time.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' }); content.innerHTML = ` <div class="message-username">${escapeHtml(user)}</div> <div class="message-text">${escapeHtml(text)}</div> <div class="message-time">${timeStr}</div> `; messageDiv.appendChild(avatar); messageDiv.appendChild(content); messagesContainer.appendChild(messageDiv); messagesContainer.scrollTop = messagesContainer.scrollHeight; } function sendMessage() { const message = messageInput.value.trim(); if (message && ws && ws.readyState === WebSocket.OPEN) { const data = { type: 'message', username: username, message: message, timestamp: Date.now() }; ws.send(JSON.stringify(data)); messageInput.value = ''; } } function escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; } loginButton.addEventListener('click', handleLogin); loginPassword.addEventListener('keypress', (e) => { if (e.key === 'Enter') { handleLogin(); } }); sendButton.addEventListener('click', sendMessage); messageInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') { sendMessage(); } }); const savedUser = localStorage.getItem('kronnos_username'); const savedHash = localStorage.getItem('kronnos_password'); if (savedUser && savedHash) { loginUsername.value = savedUser; loginPassword.focus(); } else { loginUsername.focus(); } </script> </body> </html>
